<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Having a working IPMI/ILOM card is pretty much essential when rolling out a new system to a remote location or lights-out data center. There were some issues in getting the onboard Sun IPMI card on a ...">
        <meta name="keywords" content="console, ipmi, xen">
        <link rel="icon" href="http://www.taitclarridge.com/favicon.ico">

        <title>Console Redirection with XEN and Linux for Sun iLOM/IPMI - oldmantaiter</title>

        <!-- Stylesheets -->
        <link href="http://www.taitclarridge.com/theme/css/all.min.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="http://www.taitclarridge.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="oldmantaiter Full Atom Feed" />
        <link href="http://www.taitclarridge.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="oldmantaiter Full RSS Feed" />
        <link href="http://www.taitclarridge.com/feeds/linux.atom.xml" type="application/atom+xml" rel="alternate" title="oldmantaiter Categories Atom Feed" />
        <link href="http://www.taitclarridge.com/feeds/linux.rss.xml" type="application/rss+xml" rel="alternate" title="oldmantaiter Categories RSS Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

        <!-- Google Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-45723915-1', 'auto');
          ga('send', 'pageview');
        </script>
        <!-- /Google Analytics -->

    </head>

    <body>

        <!-- Header -->
    <div class="header-container gradient">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="http://www.taitclarridge.com/">oldmantaiter</a>
                    </div>
                    <div class="nav pull-right">
                            <a href="http://www.taitclarridge.com/about.html">About</a>
                            <a href="http://www.taitclarridge.com/archives.html">Archives</a>
                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">Console Redirection with XEN and Linux for Sun iLOM/IPMI</h1>
                      <p class="header-date">By <a href="http://www.taitclarridge.com/author/tait-clarridge.html">Tait Clarridge</a>, Fri 07 October 2011, Category <a href="http://www.taitclarridge.com/category/linux.html">Linux</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
<a href="http://www.taitclarridge.com/tag/console.html">console</a>, <a href="http://www.taitclarridge.com/tag/ipmi.html">ipmi</a>, <a href="http://www.taitclarridge.com/tag/xen.html">xen</a>                      </p>
                  </div>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <p>Having a working IPMI/ILOM card is pretty much essential when rolling out a new system to a remote location or lights-out data center. There were some issues in getting the onboard Sun IPMI card on a Sun Fire X4100 (this should work for X4140 X4200 X4600 etc) to print to both the graphical console as well as the serial when using Xen.</p>
<p>One of the issues is that Xen wants to grab by default ttyS0 which is what the Sun IPMI serial port is and as I understand it, have the wrong serial port settings.</p>
<p>So here is the configuration to get it working and sending to both the serial and regular system console (VGA, IPMI redirection via web):</p>
<p>Change /etc/grub.conf to have something similar to the following:</p>
<div class="highlight"><pre><span class="go">title CentOS (xen)</span>
<span class="go">     root (hd0,0)</span>
<span class="go">       kernel /xen.gz com1=9600,8n1</span>
<span class="go">       module /vmlinuz-xen ro root=LABEL=/ console=ttyS0,9600n8 console=tty0</span>
<span class="go">       module /initrd-xen.img</span>
</pre></div>
<p>On the Xen kernel line there is one argument:</p>
<p>com1=9600,8n1 : This is the line to make the Xen console play nice with the Sun. Please note that if your IPMI console is set to another speed you will have to change 9600 to match the speed you are using.</p>
<p>On the system kernel line there are a few more added arguments:</p>
<p>console=ttyS0,9600n8 : Adding this will activate the IPMI serial console, remember that if your serial port settings are different you will need to change the 9600n8 part to whatever will match with yours.</p>
<p>console=tty0 : This just ensures that the output will be redirected to the default console (VGA etc.)</p>
<p>Edit /etc/inittab and add the below line:</p>
<div class="highlight"><pre><span class="go">co:2345:respawn:/sbin/agetty ttyS0 9600 vt100-nav</span>
</pre></div>
<p>Add ttyS0 to /etc/securetty</p>
<div class="highlight"><pre><span class="gp">[root@tclarrltp ~]#</span> <span class="nb">echo</span> <span class="s2">&quot;ttyS0&quot;</span> &gt;&gt; /etc/securetty
</pre></div>
<p>Now you should be able to see everything in the serial console via the IPMI as if it were on a monitor infront of you.</p>



            <div class="comments">
                <div id="disqus_thread"></div>
                    <script type="text/javascript">
                        var disqus_shortname = 'oldmantaiter';
                        var disqus_identifier = 'techlog/2011/10/console-redirection-with-xen-and-linux-for-sun-ilomipmi.html';
                        var disqus_url = 'http://www.taitclarridge.com/techlog/2011/10/console-redirection-with-xen-and-linux-for-sun-ilomipmi.html';
                        (function() {
                            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                        })();
                    </script>
                <noscript>Please enable JavaScript to view the comments.</noscript>
            </div>
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="http://www.taitclarridge.com/archives.html">Archives</a></li>
                            <li><a href="http://www.taitclarridge.com/tags.html">Tags</a></li>
                            <li><a href="http://www.taitclarridge.com/authors.html">Authors</a></li>
                            <li><a href="http://www.taitclarridge.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">Atom Feed</a></li>
                            <li><a href="http://www.taitclarridge.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate">RSS Feed</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Social</div>
                        <ul class="list-unstyled">
                            <li><a href="https://github.com/oldmantaiter/" target="_blank">Github</a></li>
                            <li><a href="https://twitter.com/oldmantaiter" target="_blank">Twitter</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="http://www.molivier.com/" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; Tait Clarridge 2015</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>