<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="I recently discovered a need to be able to add multiple VLANs on a single interfaces on Solaris. This one is really simple! Just make sure you are running as root, not escalating privileges with ...">
        <meta name="keywords" content="networking, vlan">
        <link rel="icon" href="http://www.taitclarridge.com/favicon.ico">

        <title>OpenIndiana (Solaris) VLAN Trunk - oldmantaiter</title>

        <!-- Stylesheets -->
        <link href="http://www.taitclarridge.com/theme/css/all.min.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="http://www.taitclarridge.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="oldmantaiter Full Atom Feed" />
        <link href="http://www.taitclarridge.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="oldmantaiter Full RSS Feed" />
        <link href="http://www.taitclarridge.com/feeds/unix.atom.xml" type="application/atom+xml" rel="alternate" title="oldmantaiter Categories Atom Feed" />
        <link href="http://www.taitclarridge.com/feeds/unix.rss.xml" type="application/rss+xml" rel="alternate" title="oldmantaiter Categories RSS Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

        <!-- Google Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-45723915-1', 'auto');
          ga('send', 'pageview');
        </script>
        <!-- /Google Analytics -->

    </head>

    <body>

        <!-- Header -->
    <div class="header-container gradient">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="http://www.taitclarridge.com/">oldmantaiter</a>
                    </div>
                    <div class="nav pull-right">
                            <a href="http://www.taitclarridge.com/about.html">About</a>
                            <a href="http://www.taitclarridge.com/archives.html">Archives</a>
                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">OpenIndiana (Solaris) VLAN Trunk</h1>
                      <p class="header-date">By <a href="http://www.taitclarridge.com/author/tait-clarridge.html">Tait Clarridge</a>, Thu 22 March 2012, Category <a href="http://www.taitclarridge.com/category/unix.html">Unix</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
<a href="http://www.taitclarridge.com/tag/networking.html">networking</a>, <a href="http://www.taitclarridge.com/tag/vlan.html">vlan</a>                      </p>
                  </div>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <p>I recently discovered a need to be able to add multiple VLANs on a single interfaces on Solaris.</p>
<p>This one is really simple! Just make sure you are running as root, not escalating privileges with pfexec.</p>
<p>So, lets start this off. Figure out which of your interfaces you want to use as the trunk, in my case it is atge0.
Make sure that you have setup whichever switchport on your switch to be a dot1q trunk</p>
<p>In this scenario I have my server originally on a switchport just in access mode on VLAN 10. To make it into a trunk (network will drop for around 30 seconds) you can reconfigure the port with the commands below to still be on VLAN 10 if using Cisco.</p>
<div class="highlight"><pre><span class="go">taiter-sw# configure terminal</span>
<span class="go">Enter configuration commands, one per line. End with CNTL/Z.</span>
<span class="go">taiter-sw(config)# interface gi0/5</span>
<span class="go">taiter-sw(config-if)# switchport</span>
<span class="go">taiter-sw(config-if)# switchport trunk encapsulation dot1q</span>
<span class="go">taiter-sw(config-if)# switchport trunk native vlan 10</span>
<span class="go">taiter-sw(config-if)# switchport mode trunk</span>
<span class="go">taiter-sw(config-if)# end</span>
</pre></div>
<p>Then issue the following commands (substituting your NIC for where I've put atge0):</p>
<div class="highlight"><pre><span class="gp">root@taiter:~#</span> dladm create-vnic -l atge0 -v <span class="m">30</span> atge0.30
</pre></div>
<p>The argument for the VLAN is -v VLANID and then you can call your new virtual interface whatever you like. I tend to like the INTERFACE.VLAN naming.</p>
<p>Now we can give an IP to the new VNIC.</p>
<div class="highlight"><pre><span class="gp">root@taiter:~#</span> ifconfig atge0.30 plumb 10.1.1.5/24 up
</pre></div>
<p>I've just shown an example, but obviously change 10.1.1.5/24 to your IP and mask that is on that VLAN.</p>



            <div class="comments">
                <div id="disqus_thread"></div>
                    <script type="text/javascript">
                        var disqus_shortname = 'oldmantaiter';
                        var disqus_identifier = 'techlog/2012/03/openindiana-solaris-vlan-trunk.html';
                        var disqus_url = 'http://www.taitclarridge.com/techlog/2012/03/openindiana-solaris-vlan-trunk.html';
                        (function() {
                            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                        })();
                    </script>
                <noscript>Please enable JavaScript to view the comments.</noscript>
            </div>
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="http://www.taitclarridge.com/archives.html">Archives</a></li>
                            <li><a href="http://www.taitclarridge.com/tags.html">Tags</a></li>
                            <li><a href="http://www.taitclarridge.com/authors.html">Authors</a></li>
                            <li><a href="http://www.taitclarridge.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">Atom Feed</a></li>
                            <li><a href="http://www.taitclarridge.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate">RSS Feed</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Social</div>
                        <ul class="list-unstyled">
                            <li><a href="https://github.com/oldmantaiter/" target="_blank">Github</a></li>
                            <li><a href="https://twitter.com/oldmantaiter" target="_blank">Twitter</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="http://www.molivier.com/" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; Tait Clarridge 2015</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>